package me.ht9.rose.feature.module.modules.exploit.fastportal;

import me.ht9.rose.event.bus.annotation.SubscribeEvent;
import me.ht9.rose.event.events.PosRotUpdateEvent;
import me.ht9.rose.feature.module.Module;
import me.ht9.rose.feature.module.annotation.Description;
import me.ht9.rose.feature.module.setting.Setting;
import me.ht9.rose.mixin.accessors.IEntityPlayer;
import net.minecraft.src.Packet10Flying;

@Description("Makes you teleport through portals faster")
public final class FastPortal extends Module
{
    private static final FastPortal instance = new FastPortal();

    private final Setting<Integer> amount = new Setting<>("Amount", 1, 5, 80);

    private FastPortal()
    {
        setArrayListInfo(() -> amount.value().toString());
    }

    @SubscribeEvent
    public void onUpdate(PosRotUpdateEvent event)
    {
        if (((IEntityPlayer) mc.thePlayer).inPortal())
        {
            for (int i = 0; i < amount.value(); i++)
                mc.getSendQueue().addToSendQueue(new Packet10Flying(mc.thePlayer.onGround));
        }
    }

    public static FastPortal instance()
    {
        return instance;
    }
}
