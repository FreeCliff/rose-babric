package me.ht9.rose.feature.module.modules.exploit.instamine;

import me.ht9.rose.event.bus.annotation.SubscribeEvent;
import me.ht9.rose.event.events.PlayerBlockClickEvent;
import me.ht9.rose.feature.module.Module;
import me.ht9.rose.feature.module.annotation.Description;
import net.minecraft.src.Block;

@Description("Attempt to instantly mine blocks")
public final class Instamine extends Module {
    private static final Instamine instance = new Instamine();

    @SuppressWarnings("unused")
    @SubscribeEvent
    public void onBlockBreak(PlayerBlockClickEvent event) {
        if (mc.theWorld == null || mc.thePlayer == null) return;

        float hardness = Block.blocksList[mc.theWorld.getBlockId(event.x(), event.y(), event.z())].getHardness();
        if (hardness < 0.0f || hardness > 10.0f) return;

        new Thread(() -> {
            try {
                while (mc.theWorld.getBlockId(event.x(), event.y(), event.z()) != 0) {
                    mc.playerController.sendBlockRemoving(event.x(), event.y(), event.z(), event.side());
                }
            } catch (Throwable ignored) {}
        }).start();
    }

    public static Instamine instance() {
        return instance;
    }
}
